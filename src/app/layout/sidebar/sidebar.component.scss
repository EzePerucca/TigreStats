// sidebar.component.scss
@use '../../../styles/variables' as *;

// ── Widths ────────────────────────────────────────────────────────────────────
$sidebar-width:           240px;
$sidebar-width-collapsed: 64px;
$transition:              all 0.25s cubic-bezier(0.4, 0, 0.2, 1);

:host {
  display: block;
  height: 100vh;
  position: sticky;
  top: 0;
  flex-shrink: 0;
}

// ── Base ──────────────────────────────────────────────────────────────────────
.sidebar {
  width: $sidebar-width;
  height: 100vh;
  background: $color-surface;
  border-right: 1px solid $color-border;
  display: flex;
  flex-direction: column;
  padding: 0;
  transition: $transition;
  overflow: hidden;
  position: relative;

  // Línea decorativa roja en el borde derecho al hacer hover
  &::after {
    content: '';
    position: absolute;
    top: 0; right: 0;
    width: 1px;
    height: 100%;
    background: linear-gradient(to bottom, transparent, $color-accent 40%, transparent);
    opacity: 0;
    transition: opacity 0.3s;
  }

  &:hover::after { opacity: 1; }

  // ── Collapsed state ──────────────────────────────────────────────────────
  &--collapsed {
    width: $sidebar-width-collapsed;

    .sidebar__logo { justify-content: center; padding: 0 0 0 0; }
    .sidebar__item { justify-content: center; padding: 0.75rem 0; }
    .sidebar__toggle { justify-content: center; padding: 1rem 0; }
  }
}

// ── Logo ──────────────────────────────────────────────────────────────────────
.sidebar__logo {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 1.5rem 1rem 1.25rem;
  border-bottom: 1px solid $color-border;
  min-height: 68px;
  transition: $transition;
}


.sidebar__logo-img {
  width: 40px;
  height: 40px;
  object-fit: contain;
  flex-shrink: 0;
  border-radius: 8px;
  margin-top: -5px; // para alinear ópticamente con el texto
}

.sidebar__logo-text {
  font-family: $font-display;
  font-size: 1.25rem;
  letter-spacing: 0.08em;
  color: $color-text;
  white-space: nowrap;
  overflow: hidden;

  em {
    font-style: normal;
    color: $color-accent;
  }
}

// ── Season badge ──────────────────────────────────────────────────────────────
.sidebar__season {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 0.75rem 1.25rem;
  font-size: 0.72rem;
  font-weight: 500;
  color: $color-text-muted;
  border-bottom: 1px solid $color-border;
  white-space: nowrap;
  overflow: hidden;
}

.sidebar__season-dot {
  width: 7px;
  height: 7px;
  border-radius: 50%;
  background: $color-accent-vivid;
  flex-shrink: 0;
  animation: pulse 1.8s ease-in-out infinite;
}

@keyframes pulse {
  0%, 100% { opacity: 1; transform: scale(1);   box-shadow: 0 0 0 0 rgba($color-accent-vivid, 0.4); }
  50%       { opacity: 0.7; transform: scale(0.9); box-shadow: 0 0 0 4px rgba($color-accent-vivid, 0); }
}

// ── Nav ───────────────────────────────────────────────────────────────────────
.sidebar__nav {
  flex: 1;
  padding: 1rem 0.75rem;
  display: flex;
  flex-direction: column;
  gap: 2px;
  overflow-y: auto;
  overflow-x: hidden;

  // Ocultar scrollbar
  scrollbar-width: none;
  &::-webkit-scrollbar { display: none; }
}

.sidebar__section-label {
  font-size: 0.65rem;
  font-weight: 700;
  letter-spacing: 0.12em;
  color: rgba($color-text-muted, 0.5);
  padding: 0 0.5rem 0.5rem;
  display: block;
  white-space: nowrap;
}

// ── Nav Item ──────────────────────────────────────────────────────────────────
.sidebar__item {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 0.65rem 0.75rem;
  border-radius: 8px;
  text-decoration: none;
  color: $color-text-muted;
  font-size: 0.88rem;
  font-weight: 500;
  white-space: nowrap;
  transition: background 0.15s, color 0.15s;
  position: relative;

  &:hover {
    background: rgba(255,255,255,0.05);
    color: $color-text;
  }

  // ── Active state ──────────────────────────────────────────────────────────
  &--active {
    background: rgba($color-accent, 0.12);
    color: $color-text;

    .sidebar__icon { color: $color-accent; }

    // Línea izquierda
    &::before {
      content: '';
      position: absolute;
      left: 0; top: 20%; bottom: 20%;
      width: 3px;
      background: $color-accent;
      border-radius: 0 2px 2px 0;
    }
  }
}

.sidebar__icon {
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  width: 20px;
  color: inherit;
  transition: color 0.15s;
}

.sidebar__label {
  overflow: hidden;
  text-overflow: ellipsis;
}

// ── Toggle button ─────────────────────────────────────────────────────────────
.sidebar__toggle {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 1rem 1.25rem;
  border: none;
  background: none;
  color: $color-text-muted;
  font-family: $font-body;
  font-size: 0.78rem;
  cursor: pointer;
  border-top: 1px solid $color-border;
  width: 100%;
  transition: color 0.15s;
  white-space: nowrap;
  overflow: hidden;

  &:hover { color: $color-text; }

  svg { flex-shrink: 0; }
}
